from clickhouse_driver import Client

def create_clickhouse_schema():
    ch_client = Client(host='localhost', database='hafil_dev_afc')

    ch_client.execute('''
        CREATE TABLE IF NOT EXISTS afct_financial_table
        (
            dtype String,
            activity_type String,
            actual_alighting_stop_code Nullable(String),
            actual_alighting_zone_code Nullable(String),
            actual_boarding_stop_code Nullable(String),
            actual_boarding_zone_code Nullable(String),
            block_ref Nullable(String),
            driver_name Nullable(String),
            driver_ref Nullable(String),
            latitude Nullable(Int32),
            longitude Nullable(Int32),
            pattern Nullable(String),
            route_destination Nullable(String),
            route_external_id Nullable(String),
            route_name Nullable(String),
            route_status Nullable(String),
            route_variant Nullable(String),
            route_version Nullable(String),
            run_ref Nullable(String),
            stop_code Nullable(String),
            stop_name Nullable(String),
            vehicle_ref Nullable(String),
            boarding_activity Nullable(String),
            cumulative_fare_or_product_price Int32,
            currency_code String,
            deny_reason Nullable(String),
            device_component_id Nullable(String),
            device_component_type Nullable(String),
            device_id String,
            device_transaction_counter UInt64,
            device_type String,
            device_version String,
            fare_item_category String,
            fare_item_external_id Int32,
            fare_item_name String,
            fare_item_type String,
            fare_system_model Nullable(String),
            fare_table_timestamp DateTime,
            issued_alighting_stop_code Nullable(String),
            issued_alighting_zone_code Nullable(String),
            issued_boarding_stop_code Nullable(String),
            issued_boarding_zone_code Nullable(String),
            journey_distance_traveled Nullable(Int32),
            journey_stages_or_zones_traveled Nullable(Int32),
            location_external_id String,
            location_name String,
            operation_mode String,
            operator_ref Nullable(String),
            operator_type_external_id Int32,
            operator_type_name String,
            organization_external_id String,
            organization_name String,
            paying_rider_type_external_id Int32,
            paying_rider_type_name String,
            payment_instrument String,
            payment_method String,
            penalty_fee Nullable(Int32),
            public_transport_organization_ref Nullable(String),
            revenue_mode String,
            route_system_type Nullable(String),
            route_type_external_id Nullable(Int32),
            route_type_name Nullable(String),
            timestamp DateTime,
            trip_distance_traveled Nullable(Int32),
            trip_stages_or_zones_traveled Nullable(Int32),
            validation_status Nullable(String),
            action_alic Nullable(Int32),
            action_alwc Nullable(Int32),
            action_kept_in_queue Nullable(UInt8),
            action_name Nullable(String),
            action_sequence_number Nullable(Int32),
            action_success Nullable(UInt8),
            activate_on_first_usage Nullable(UInt8),
            alic Nullable(Int32),
            alwc Nullable(Int32),
            card_block_unblock_timestamp Nullable(DateTime),
            card_id Nullable(String),
            card_iteration Nullable(Int32),
            card_transaction_counter Nullable(Int32),
            card_type Nullable(String),
            contract_category Nullable(String),
            contract_id Nullable(Int32),
            deduct_value Nullable(Int32),
            extra_data Nullable(String),
            first_use Nullable(UInt8),
            instance_id Nullable(String),
            issue_type Nullable(String),
            issuer_id Nullable(Int32),
            new_epurse_value Nullable(Int32),
            new_rider_type Nullable(Int32),
            number_of_purchase Nullable(Int32),
            period_pass_expiration_timestamp Nullable(DateTime),
            previous_epurse_value Nullable(Int32),
            previous_rider_type Nullable(Int32),
            product_id Nullable(Int32),
            remaining_rides Nullable(Int32),
            sales_amount Nullable(Int32),
            ticket_valid_seconds Nullable(Int32),
            transfers_left Nullable(Int32),
            validation_type Nullable(String),
            journey_start_timestamp Nullable(DateTime),
            trip_id Nullable(String),
            card_holder_address_line1 Nullable(String),
            card_holder_address_line2 Nullable(String),
            card_holder_address_line3 Nullable(String),
            card_holder_city Nullable(String),
            card_holder_country_code Nullable(String),
            card_holder_country_province Nullable(String),
            card_holder_day_of_birth Nullable(DateTime),
            card_holder_employee_id Nullable(String),
            card_holder_employee_type_external_id Nullable(String),
            card_holder_employee_type_name Nullable(String),
            card_holder_first_name Nullable(String),
            card_holder_gender Nullable(String),
            card_holder_identification_expiry Nullable(DateTime),
            card_holder_identification_id Nullable(String),
            card_holder_identification_name Nullable(String),
            card_holder_identification_type Nullable(String),
            card_holder_last_name Nullable(String),
            card_holder_phone_number Nullable(String),
            card_holder_postal_code Nullable(String),
            card_holder_type Nullable(String),
            card_printed_id Nullable(String),
            deny_description Nullable(String),
            card_free_text Nullable(String),
            driver_dispatch_duty_code Nullable(String),
            driver_dispatch_run_code Nullable(String),
            driver_dispatch_workday_code Nullable(String),
            driver_duty_start_timestamp Nullable(DateTime),
            driver_run_start_timestamp Nullable(DateTime),
            trip_start_timestamp Nullable(DateTime),
            device_shared_id Nullable(String),
            security_element_id Nullable(String),
            security_element_transaction_counter Nullable(Int32),
            terminal_id UInt64,
            terminal_type_id Nullable(Int32),
            activity_type_short_number Nullable(Int32),
            cumulative_fare_or_product_code Nullable(String),
            fare_item_extended_ticket_type_code Nullable(String),
            fare_item_shared_code Nullable(String),
            payment_instrument_id Nullable(String),
            payment_instrument_uid Nullable(String),
            card_binary_snapshot_contract Nullable(String),
            card_binary_snapshot_contract_authenticator Nullable(String),
            card_binary_snapshot_contract_counter Nullable(String),
            card_binary_snapshot_environment_and_holder Nullable(String),
            card_binary_snapshot_event_log_record1 Nullable(String),
            card_binary_snapshot_event_log_record2 Nullable(String),
            card_binary_snapshot_event_log_record3 Nullable(String),
            card_binary_snapshot_special_event Nullable(String),
            card_binary_snapshot_transaction_contract_pointer Nullable(String),
            vehicle_registration_plate Nullable(String),
            pole_number Nullable(Int32),
            related_transaction_information_id Nullable(Int32),
            operator_comment Nullable(String),
            reason_id Nullable(Int32),
            uploaded_by Nullable(String),
            card_version Nullable(String),
            operator_dispatch_duty_code Nullable(String),
            operator_dispatch_run_code Nullable(String),
            operator_dispatch_workday_code Nullable(String),
            custom_purchase Nullable(String),
            fare_item_issued_expiration_timestamp Nullable(DateTime),
            fare_item_issued_number Nullable(String),
            fare_item_purchased_rides Nullable(Int32),
            fare_item_purchased_stages_or_zones Nullable(Int32),
            fare_item_purchased_transfers Nullable(Int32),
            journey_id Nullable(Int64),
            journey_sequence_counter Nullable(Int16),
            journey_visited_reduced_intersections Nullable(String),
            journey_visited_shared_zones Nullable(Int64),
            journey_visited_zones Nullable(Int64),
            merchant_organization_id Nullable(Int32),
            payingrideraccountid Nullable(Int64),
            reason_name Nullable(String),
            processing_finish_timestamp DateTime,
            payment_instrument_transaction_id Nullable(String),
            item_reference_id Nullable(String),
            actual_alighting_station_code Nullable(String),
            actual_boarding_station_code Nullable(String),
            issued_alighting_station_code Nullable(String),
            issued_boarding_station_code Nullable(String),
            alighting_timestamp Nullable(DateTime),
            boarding_timestamp Nullable(DateTime),
            device_duty_code Nullable(String),
            trip_estimated_end_timestamp Nullable(DateTime),
            login_account_access_application_name Nullable(String),
            login_account_access_application_version Nullable(String),
            login_account_access_device_ip_address Nullable(String),
            login_account_access_device_name Nullable(String),
            new_device_balance Nullable(Int32),
            previous_device_balance Nullable(Int32),
            security_element_counter_code Nullable(String),
            transaction_external_reference_code Nullable(String),
            total_payment_in_cents Nullable(Int32),
            total_vat_in_cents Nullable(Int32),
            vat_added_to_total_payment Nullable(UInt8),
            card_type_short_number Nullable(Int32),
            card_version_short_number Nullable(Int32),
            contract_start_timestamp Nullable(DateTime),
            contract_status Nullable(String),
            contract_type Nullable(String),
            file_name Nullable(String),
            id UInt64,
            tax_invoice_information_id Nullable(Int64),
            sales_order_external_reference_code Nullable(String),
            sales_order_id_number Nullable(Int64),
            fare_item_product_type Nullable(String),
            booking_reference Nullable(String),
            e_ticket_reference Nullable(String),
            reservation_seat Nullable(String)
        ) ENGINE = MergeTree() ORDER BY id SETTINGS index_granularity = 8192;
    ''')
    print("ClickHouse schema for afct_financial_table created successfully.")

if __name__ == "__main__":
    create_clickhouse_schema()
